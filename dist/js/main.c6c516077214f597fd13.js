(()=>{"use strict";var e={420:()=>{window.addEventListener("DOMContentLoaded",(function(){var e=document.getElementById("MainBurgerMenuToggler"),t=document.querySelector(".main-header__menu-button"),n=document.getElementById("HeaderMenu"),o=document.querySelector(".main-header__menu-list"),i=!1;e.addEventListener("click",(function(){t.classList.toggle("toggler--active"),i?(o.classList.remove("smoothlyShow"),o.classList.add("smoothlyHide"),setTimeout((function(){o.classList.add("collapse")}),300),n.classList.remove("menu--opened"),i=!1):(n.classList.add("menu--opened"),o.classList.remove("collapse"),o.classList.remove("smoothlyHide"),o.classList.add("smoothlyShow"),i=!0)}));var c=document.getElementById("LeftBurgerMenuToggler");if(c){var r=document.querySelector(".main-header__menu-button--left"),s=document.getElementById("Sidebar"),a=!1;c.addEventListener("click",(function(){a?(r.classList.remove("menu--left"),s.classList.remove("left-menu--opened"),setTimeout((function(){s.classList.remove("left-menu--max-height")}),500),a=!1):(f(),r.classList.add("menu--left"),s.classList.add("left-menu--max-height"),setTimeout((function(){s.classList.add("left-menu--opened")}),100),a=!0)}));var u=document.querySelectorAll(".sidebar__link--spoiler"),l=(document.querySelectorAll(".sidebar__link-icon"),document.querySelectorAll(".sidebar__list--spoiler"),function(e){return sessionStorage.getItem(e)}),d=function(e,t,n,o){!function(e,t){sessionStorage.setItem(e.id,t)}(e,t),function(e,t,n){var o=e.parentNode.querySelector(".sidebar__list");o.style.height=function(e,t){if(!t)return 0;var n=e.querySelectorAll(".sidebar__elem"),o=0;return n.forEach((function(e){var t=e.getBoundingClientRect().height;o+=t})),o}(o,t)+"px",o.style.transition=n}(e,o,n),function(e,t,n){var o=e.parentNode.querySelector(".sidebar__link-icon");"open"===t?o.classList.remove("rotate-arrow"):"close"===t&&o.classList.add("rotate-arrow"),o.style.transition="all "+n}(e,t,n)};u.forEach((function(e){return e.addEventListener("click",(function(e){var t=e.target,n=l(t.id);n&&"close"!==n?"open"===n&&d(t,"close","0.7s",0):d(t,"open","0.7s",!0)}))}));var f=function(){u.forEach((function(e){var t=l(e.id);"close"===t?d(e,"close","0s",0):"open"===t&&d(e,"open","0s",!0)}))};f()}}))},973:()=>{function e(e,t,n,o,i,c,r){try{var s=e[c](r),a=s.value}catch(e){return void n(e)}s.done?t(a):Promise.resolve(a).then(o,i)}function t(t){return function(){var n=this,o=arguments;return new Promise((function(i,c){var r=t.apply(n,o);function s(t){e(r,i,c,s,a,"next",t)}function a(t){e(r,i,c,s,a,"throw",t)}s(void 0)}))}}var n,o="purchases_notices",i="offers_notices",c="auctions_notices",r="contracts_notices",s="deals_notices",a="finance_notices";window.addEventListener("DOMContentLoaded",(function(){var e=[],u=(document.querySelector(".main-menu__dialogs"),document.getElementById("dialogNewMessageIcon")),l=$("#PurchasesQty"),d=$("#PurchasesNotice"),f=$("#OffersQty"),m=$("#OffersNotice"),p=$("#AuctionsQty"),g=$("#AuctionsNotice"),h=$("#ContractsQty"),v=$("#ContractsNotice"),y=$("#DealsQty"),L=$("#DealsNotice"),N=$("#FinancesQty"),w=$("#FinansesNotice");function _(){return(_=t(regeneratorRuntime.mark((function o(){return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return(n=(new signalR.HubConnectionBuilder).withUrl("/Notifications/NotificationHub").build()).onclose(t(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k(1e4);case 2:case"end":return e.stop()}}),e)})))),n.on("UpdateNotificationCounters",(function(e){S(e.unreadDialogCount),x(l,e.purchaseNoticeCount),x(f,e.offersNoticeCount),x(p,e.auctionNoticeCount),x(h,e.updatedContractCount),x(y,e.updatedDealCount),x(N,e.financeNoticeCount),e.sumCount>0?B():q()})),n.on("ReceiptedNewMessage",(function(t){var n="#dialog_"+t;e.includes(n)||($(n).find("span.dialogs-title").after('<div class="dialogs-title dialogs-new-message-trigger--temp"><span class="dialog-new-message-button--temp">Новое сообщение</span></div>'),$(n).find("img").attr("src","/images/convert.svg"),e.push(n));S(e.length)})),n.on("DialogReaded",(function(t){var n="#dialog_"+t;e.includes(n)&&e.splice(n),S(e.length)})),n.on("PurchaseNotification",(function(){A(l),B()})),n.on("OfferNotification",(function(){A(f),B()})),n.on("AuctionNotification",(function(){A(p),B()})),n.on("ContractNotification",(function(){A(h),B()})),n.on("DealNotification",(function(){A(y),B()})),n.on("FinanceNotification",(function(){A(N),B()})),n.on("DisplayPurchasesNotices",(function(e){D(d,e),x(l,e)})),n.on("DisplayOffersNotices",(function(e){D(m,e),x(f,e)})),n.on("DisplayAuctionsNotices",(function(e){D(g,e),x(p,e)})),n.on("DisplayContractsNotices",(function(e){D(v,e),x(h,e)})),n.on("DisplayDealsNotices",(function(e){D(L,e),x(y,e)})),n.on("DisplayFinanceNotices",(function(e){e.forEach((function(e){return console.log(e.isNew)})),D(w,e),x(N,e)})),o.next=19,E();case 19:case"end":return o.stop()}}),o)})))).apply(this,arguments)}function E(){return b.apply(this,arguments)}function b(){return(b=t(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n.logging=!0,e.next=4,n.start();case 4:console.log("notifications connected."),n.invoke("GetNotifications").catch((function(e){return console.log(e.toString())})),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function k(e,t){return C.apply(this,arguments)}function C(){return(C=t(regeneratorRuntime.mark((function e(t,o){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.start();case 3:o?(console.log("notice hub reloading..."),window.location.reload(!0)):console.log("notice hub connected."),e.next=10;break;case 6:e.prev=6,e.t0=e.catch(0),console.log(e.t0),setTimeout((function(){return k(t,!0)}),t);case 10:case"end":return e.stop()}}),e,null,[[0,6]])})))).apply(this,arguments)}function S(e){e>0?u.classList.remove("collapse"):u.classList.add("collapse")}function x(e,t){t>0?e.html(t):e.html("0")}function A(e){var t=parseInt(e.html());t++,e.html(t)}function D(e,t){var n,o;t.length||(n=e,(o=document.createElement("li")).textContent="Оповещений нет",o.classList.add("drop-card__link"),n.append(o)),t.reverse().forEach((function(t){var n=document.createElement("li");n.classList.add("drop-card__item"),t.isNew&&n.classList.add("item--isNew");var o=document.createElement("a");if(o.classList.add("drop-card__link"),o.href="/Notification/RedirectToSource?id="+t.id,o.textContent=t.title,t.message){var i=document.createElement("span");i.classList.add("drop-card__message"),i.textContent=t.message,o.appendChild(i)}n.appendChild(o),e.append(n)}))}function B(){$("#DropdownToggler").addClass("pulsingButton")}function q(){$("#DropdownToggler").removeClass("pulsingButton")}var R=!1,I=!1,T=!1,M=!1,O=!1,G=!1;if(document.getElementById("ReadAllNotices")){document.querySelectorAll(".drop-card").forEach((function(e){e.addEventListener("click",W)})),document.getElementById("ReadAllNotices").addEventListener("click",(function(){n.invoke("ReadAll").catch((function(e){return console.log(e.toString())}))}));var H=document.getElementById("DropdownToggler"),P=document.getElementById("DropdownMenu"),Q=document.querySelector(".fa-bell");H.addEventListener("click",(function(){var e=H.getAttribute("data-state");switch(console.log(e),e){case"closed":P.classList.remove("collapse"),P.classList.remove("smoothlyHide"),P.classList.add("smoothlyShow"),H.setAttribute("data-state","opened");break;case"opened":X()}})),document.addEventListener("click",(function(e){e.target.closest("#DropdownMenu")||e.target===H||e.target===Q||X()}));var F=document.querySelectorAll(".toggler--js"),U=document.querySelectorAll(".drop-card__qty"),j=null,z=null;F.forEach((function(e){e.addEventListener("click",(function(){var t="card-"+e.dataset.id,n=(j=document.querySelector("[data-id="+t+"]")).getAttribute("data-state");"closed"===n?Y(j,200,"opened"):"opened"===n&&Y(j,0,"closed"),z&&z!==j&&Y(z,0,"closed"),z=j,setTimeout((function(){var e,t;e=+U.length,t=0,U.forEach((function(e){"0"==e.textContent&&t++})),t>=e&&H.classList.remove("pulsingButton")}),1500)}))}));var J=document.getElementById("headerOrganizationName");if(!J)return!1;var K=J.textContent;if(K.length>39){var V=K.slice(0,39);J.textContent=V+"..."}!function(){_.apply(this,arguments)}()}function W(){this.getAttribute("data-type").split(" ").forEach((function(e){!function(e){var t;switch(e){case o:if(R)return;R=!0,t="GetPurchasesNotices";break;case i:if(I)return;I=!0,t="GetOffersNotices";break;case c:if(T)return;T=!0,t="GetAuctionsNotices";break;case r:if(M)return;M=!0,t="GetContractsNotices";break;case s:if(O)return;O=!0,t="GetDealsNotices";break;case a:if(G)return;G=!0,t="GetFinanceNotices";break;default:return}n.invoke(t).catch((function(e){return console.log(e.toString())}))}(e)}))}function X(){P.classList.remove("smoothlyShow"),P.classList.add("smoothlyHide"),setTimeout((function(){P.classList.add("collapse")}),300),H.setAttribute("data-state","closed")}function Y(e,t,n){e.style.height=t+"px",e.setAttribute("data-state",n)}}))}},t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={exports:{}};return e[o](i,i.exports,n),i.exports}n(973),n(420)})();